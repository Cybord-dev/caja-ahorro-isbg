(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"3k/E":function(i,t,s){"use strict";s.d(t,"a",(function(){return e}));class e{constructor(){this.validaciones=[],this.atributos=[]}}},uwdg:function(i,t,s){"use strict";s.d(t,"a",(function(){return D}));var e=s("mrSG"),o=s("s7LF"),a=s("KZhB");class r{constructor(i,t,s){this.tipoDato=i,this.dato=t,this.relevancia=s}}var n=s("8Y7J"),c=s("iInd"),d=s("qVGJ"),b=s("SVse"),u=s("ienR");function l(i,t){if(1&i&&(n.Ob(0,"p"),n.tc(1),n.Nb()),2&i){const i=t.$implicit;n.xb(1),n.uc(i)}}function f(i,t){if(1&i&&(n.Ob(0,"div",42),n.sc(1,l,2,1,"p",43),n.Nb()),2&i){const i=n.Xb();n.xb(1),n.dc("ngForOf",i.errorMessages)}}function h(i,t){if(1&i&&(n.Ob(0,"p",44),n.tc(1),n.Nb()),2&i){const i=n.Xb();n.xb(1),n.uc(i.Params.success)}}function g(i,t){1&i&&(n.Ob(0,"div"),n.tc(1,"El correo es requerido."),n.Nb())}function m(i,t){1&i&&(n.Ob(0,"div"),n.tc(1,"La direccion introducida no es valida. "),n.Nb())}function p(i,t){1&i&&(n.Ob(0,"div"),n.tc(1,"Hay caracteres invalidos."),n.Nb())}function v(i,t){if(1&i&&(n.Ob(0,"div",45),n.sc(1,g,2,0,"div",46),n.sc(2,m,2,0,"div",46),n.sc(3,p,2,0,"div",46),n.Nb()),2&i){const i=n.Xb();n.xb(1),n.dc("ngIf",i.f.email.errors.required),n.xb(1),n.dc("ngIf",i.f.email.errors.email),n.xb(1),n.dc("ngIf",i.f.email.errors.pattern)}}function O(i,t){1&i&&(n.Ob(0,"div"),n.tc(1,"El alias es requerido."),n.Nb())}function N(i,t){1&i&&(n.Ob(0,"div"),n.tc(1,"Nececitas un minimo de 2 caracteres. "),n.Nb())}function M(i,t){1&i&&(n.Ob(0,"div"),n.tc(1,"No mas de 20 caracteres."),n.Nb())}function x(i,t){1&i&&(n.Ob(0,"div"),n.tc(1,"Hay caracteres invalidos."),n.Nb())}function I(i,t){if(1&i&&(n.Ob(0,"div",45),n.sc(1,O,2,0,"div",46),n.sc(2,N,2,0,"div",46),n.sc(3,M,2,0,"div",46),n.sc(4,x,2,0,"div",46),n.Nb()),2&i){const i=n.Xb();n.xb(1),n.dc("ngIf",i.f.alias.errors.required),n.xb(1),n.dc("ngIf",i.f.alias.errors.minlength),n.xb(1),n.dc("ngIf",i.f.alias.errors.maxlength),n.xb(1),n.dc("ngIf",i.f.alias.errors.pattern)}}function C(i,t){if(1&i){const i=n.Pb();n.Ob(0,"button",47),n.Vb("click",(function(){return n.mc(i),n.Xb().registry()})),n.tc(1," Registrar"),n.Nb()}if(2&i){const i=n.Xb();n.dc("disabled",""!==i.Params.success)}}function U(i,t){if(1&i){const i=n.Pb();n.Ob(0,"button",47),n.Vb("click",(function(){return n.mc(i),n.Xb().update()})),n.tc(1," Actualizar"),n.Nb()}if(2&i){const i=n.Xb();n.dc("disabled",1==i.actualizando)}}const q=function(i){return{"is-invalid":i}};let D=(()=>{class i{constructor(i,t,s,e){this.route=i,this.usuarioServicio=t,this.formBuilder=s,this.router=e,this.submitted=!1,this.loading=!0,this.usuario=new a.a,this.errorMessages=[],this.Params={success:"",message:"",id:"*",module:"usuarios"},this.date=new Date,this.datos={ANTIGUEDAD:this.date,SUELDO:0,NO_EMPLEADO:0,OFICINA:"*"}}ngOnInit(){this.loading=!0,this.errorMessages=[],this.Params.module=this.router.url.split("/")[1],this.route.paramMap.subscribe(i=>{const t=i.get("idUsuario");"*"!==t?(this.updateUserInfo(+t),this.registerForm=this.formBuilder.group({email:[{value:this.usuario.email,disabled:!0}],alias:["",[o.q.required,o.q.maxLength(20),o.q.minLength(2),o.q.pattern("^([0-9a-zA-Z\xc0-\xfa.,&-_!\xa1\" ' ]+)$")]],activo:["Si",o.q.required],tipo:[this.usuario.tipoUsuario]})):(this.date=new Date,this.registerForm=this.formBuilder.group({email:[{value:this.usuario.email,disabled:!1},[o.q.required,o.q.email,o.q.pattern("^[a-z0-9A-Z._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$")]],alias:["",[o.q.required,o.q.maxLength(20),o.q.minLength(2),o.q.pattern("^([0-9a-zA-Z\xc0-\xfa.,&-_!\xa1\"' ]+)$")]],activo:["Si",o.q.required],tipo:[this.usuario.tipoUsuario]}),this.loading=!1)})}get f(){return this.registerForm.controls}update(){return Object(e.a)(this,void 0,void 0,(function*(){if(this.submitted=!0,this.loading=!0,this.registerForm.invalid)return void(this.loading=!1);const i=this.usuario.id;this.usuarioServicio.actualizaUser(this.usuario).toPromise().then(i=>Object(e.a)(this,void 0,void 0,(function*(){this.Params.success="El usuario ha sido actualizado satisfactoriamente.";for(const t in this.datos)(void 0===this.datos[t]||""===this.datos[t]||0===this.datos[t]&&i.datosUsuario.find(i=>i.tipoDato===t))&&(yield this.usuarioServicio.deleteDatosUsuario(i.datosUsuario.find(i=>i.tipoDato===t).id).toPromise());for(const i in this.datos)yield this.usuarioServicio.actualizaDatoUsuario(this.usuario.id,new r(i,this.datos[i],!0)).toPromise()})),i=>this.errorMessages.push(i.error.message||`${i.statusText} : ${i.message}`)).then(()=>this.updateUserInfo(i))}))}registry(){this.submitted=!0,this.registerForm.invalid?this.loading=!1:(this.errorMessages=[],this.usuarioServicio.insertarUsuario(this.usuario).subscribe(i=>{this.Params.success="El usuario ha sido creado satisfactoriamente.";for(const t in this.datos)void 0!==this.datos[t]&&this.usuarioServicio.insertarDatosUsuario(i.id,new r(t,this.datos[t],!0)).subscribe(i=>{this.Params.success="Datos insertados satisfactoriamente."},i=>this.errorMessages.push(i.error.message||`${i.statusText} : ${i.message}`))},i=>this.errorMessages.push(i.error.message||`${i.statusText} : ${i.message}`)))}clearInput(){this.usuario=new a.a,this.Params.success="",this.errorMessages=[],this.submitted=!1}updateUserInfo(i){this.errorMessages=[],this.usuarioServicio.getUsuario(i).subscribe(i=>{this.usuario=i;for(const t in this.usuario.datosUsuario)for(const i in this.datos)this.usuario.datosUsuario[t].tipoDato===i&&(this.datos[i]=this.usuario.datosUsuario[t].dato);this.datos.ANTIGUEDAD&&(this.date=new Date(this.datos.ANTIGUEDAD))},i=>this.errorMessages.push(i.error.message||`${i.statusText} : ${i.message}`))}}return i.\u0275fac=function(t){return new(t||i)(n.Ib(c.a),n.Ib(d.a),n.Ib(o.c),n.Ib(c.c))},i.\u0275cmp=n.Cb({type:i,selectors:[["cybord-usuario"]],decls:78,vars:21,consts:[[1,"animated","fadeIn"],[1,"row"],[1,"col-sm-12","col-md-12"],[1,"card"],[1,"card-header"],[1,"card-body"],["class","alert alert-warning","role","alert",4,"ngIf"],["class","alert alert-success","role","alert",4,"ngIf"],[1,"row","slide_1"],[1,"col-6"],[1,"col",3,"formGroup"],[1,"col"],["for","inputCorreo",1,"label"],["type","text","formControlName","email","placeholder","Correo Electronico",1,"form-control",3,"ngClass","ngModel","ngModelChange"],["class","invalid-feedback",4,"ngIf"],["for","inputtipo",1,"label"],["type","text","formControlName","tipo","placeholder","tipo usuario",1,"form-control",3,"ngModel","ngModelChange"],["for","inputActivo",1,"label"],["id","inputActivo","formControlName","activo","fullWidth","",1,"form-control",2,"display","block",3,"ngModel","ngModelChange"],["value","true"],["value","false"],["for","inputAlias",1,"label"],["type","text","formControlName","alias","placeholder","Sobrenombre o alias",1,"form-control",3,"ngClass","ngModel","ngModelChange"],["action","","method","post","enctype","multipart/form-data",1,"form-horizontal"],["for","start-date",1,"label"],[1,""],["id","start-date","type","text","bsDatepicker","",1,"form-control",3,"bsValue"],["dp","bsDatepicker"],["for","quantity",1,"label"],["type","number","id","quantity","name","text-inputafg","min","1","placeholder","1.00",1,"form-control",3,"ngModel","ngModelChange"],["for","no-emp",1,"label"],["type","number","id","no-emp","name","text-inputa","placeholder","No empleado",1,"form-control",3,"ngModel","ngModelChange"],["for","office",1,"label"],["id","office","name","office",1,"form-control",3,"ngModel","ngModelChange"],["value","*"],["value","1"],["value","2"],["value","3"],["value","4"],[1,"card-footer"],[1,"float-right","slide_2"],["class","btn btn-primary",3,"disabled","click",4,"ngIf"],["role","alert",1,"alert","alert-warning"],[4,"ngFor","ngForOf"],["role","alert",1,"alert","alert-success"],[1,"invalid-feedback"],[4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"]],template:function(i,t){1&i&&(n.Ob(0,"div",0),n.Ob(1,"div",1),n.Ob(2,"div",2),n.Ob(3,"div",3),n.Ob(4,"div",4),n.Ob(5,"strong"),n.tc(6,"Usuarios"),n.Nb(),n.Nb(),n.Ob(7,"div",5),n.sc(8,f,2,1,"div",6),n.sc(9,h,2,1,"p",7),n.Ob(10,"div",8),n.Ob(11,"div",9),n.Ob(12,"form",10),n.Ob(13,"div",1),n.Ob(14,"div",11),n.Ob(15,"label",12),n.tc(16,"Email"),n.Nb(),n.Ob(17,"input",13),n.Vb("ngModelChange",(function(i){return t.usuario.email=i})),n.Nb(),n.sc(18,v,4,3,"div",14),n.Nb(),n.Ob(19,"div",11),n.Ob(20,"label",15),n.tc(21,"Tipo Usuario"),n.Nb(),n.Ob(22,"input",16),n.Vb("ngModelChange",(function(i){return t.usuario.tipoUsuario=i})),n.Nb(),n.Nb(),n.Nb(),n.Jb(23,"br"),n.Ob(24,"div",1),n.Ob(25,"div",11),n.Ob(26,"label",17),n.tc(27,"Activo"),n.Nb(),n.Ob(28,"select",18),n.Vb("ngModelChange",(function(i){return t.usuario.activo=i})),n.Ob(29,"option",19),n.tc(30,"Si"),n.Nb(),n.Ob(31,"option",20),n.tc(32,"No"),n.Nb(),n.Nb(),n.Nb(),n.Ob(33,"div",11),n.Ob(34,"label",21),n.tc(35,"Nombre"),n.Nb(),n.Ob(36,"input",22),n.Vb("ngModelChange",(function(i){return t.usuario.nombre=i})),n.Nb(),n.sc(37,I,5,4,"div",14),n.Nb(),n.Nb(),n.Nb(),n.Nb(),n.Ob(38,"div",9),n.Ob(39,"form",23),n.Ob(40,"div",1),n.Ob(41,"div",11),n.Ob(42,"label",24),n.tc(43,"Fecha Antiguedad"),n.Nb(),n.Ob(44,"div",25),n.Jb(45,"input",26,27),n.Nb(),n.Nb(),n.Ob(47,"div",11),n.Ob(48,"label",28),n.tc(49,"Sueldo"),n.Nb(),n.Ob(50,"div",25),n.Ob(51,"input",29),n.Vb("ngModelChange",(function(i){return t.datos.SUELDO=i})),n.Nb(),n.Nb(),n.Nb(),n.Nb(),n.Jb(52,"br"),n.Ob(53,"div",1),n.Ob(54,"div",11),n.Ob(55,"label",30),n.tc(56,"No. empleado"),n.Nb(),n.Ob(57,"div",25),n.Ob(58,"input",31),n.Vb("ngModelChange",(function(i){return t.datos.NO_EMPLEADO=i})),n.Nb(),n.Nb(),n.Nb(),n.Ob(59,"div",11),n.Ob(60,"label",32),n.tc(61,"Oficina"),n.Nb(),n.Ob(62,"div",25),n.Ob(63,"select",33),n.Vb("ngModelChange",(function(i){return t.datos.OFICINA=i})),n.Ob(64,"option",34),n.tc(65,"Seleccionar"),n.Nb(),n.Ob(66,"option",35),n.tc(67,"Oficina #1"),n.Nb(),n.Ob(68,"option",36),n.tc(69,"Oficina #2"),n.Nb(),n.Ob(70,"option",37),n.tc(71,"Oficina #3"),n.Nb(),n.Ob(72,"option",38),n.tc(73,"Oficina #4"),n.Nb(),n.Nb(),n.Nb(),n.Nb(),n.Nb(),n.Nb(),n.Nb(),n.Nb(),n.Nb(),n.Ob(74,"div",39),n.Ob(75,"div",40),n.sc(76,C,2,1,"button",41),n.sc(77,U,2,1,"button",41),n.Nb(),n.Nb(),n.Nb(),n.Nb(),n.Nb(),n.Nb()),2&i&&(n.xb(8),n.dc("ngIf",t.errorMessages.length>0),n.xb(1),n.dc("ngIf",t.Params.success.length>0),n.xb(3),n.dc("formGroup",t.registerForm),n.xb(5),n.dc("ngClass",n.gc(17,q,t.submitted&&t.f.email.errors))("ngModel",t.usuario.email),n.xb(1),n.dc("ngIf",t.submitted&&t.f.email.errors),n.xb(4),n.dc("ngModel",t.usuario.tipoUsuario),n.xb(6),n.dc("ngModel",t.usuario.activo),n.xb(8),n.dc("ngClass",n.gc(19,q,t.submitted&&t.f.alias.errors))("ngModel",t.usuario.nombre),n.xb(1),n.dc("ngIf",t.submitted&&t.f.alias.errors),n.xb(8),n.dc("bsValue",t.date),n.xb(6),n.dc("ngModel",t.datos.SUELDO),n.xb(7),n.dc("ngModel",t.datos.NO_EMPLEADO),n.xb(5),n.dc("ngModel",t.datos.OFICINA),n.xb(13),n.dc("ngIf",void 0===t.usuario.id),n.xb(1),n.dc("ngIf",void 0!==t.usuario.id))},directives:[b.m,o.s,o.j,o.e,o.b,o.i,o.d,b.k,o.p,o.m,o.r,o.k,u.b,u.a,o.n,o.l,b.l],styles:[""]}),i})()}}]);